---
title: "The 2026 Winter Olympics"
subtitle: "TidyTuesday Week 6"
author: "Gokturk Colak"
date: "2026-02-13"
output: html_document
editor_options: 
  chunk_output_type: console
---

## 1. Libraries and Data Upload

```{r}
library(tidyverse)
library(showtext)
library(stringr)
library(ggbranding)
library(patchwork)

olympic_schedule <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2026/2026-02-10/schedule.csv')
```

### 1.2 Set theme

```{r}
# Font setup 

font_add_google("Commissioner")
showtext_auto()
showtext_opts(dpi = 300)

# Theme style

font_main  <- "Commissioner"
col_title  <- "grey10"
col_text   <- "grey30"
col_accent <- "#0A2342"
```

## 2 Initial exploratory data analysis

### How many events exist per discipline?

```{r}

olympic_schedule %>%  count(discipline_name, sort = TRUE)

```

### On which day and at what time do most medal events occur?

```{r}
olympic_schedule %>% 
  filter(is_medal_event == TRUE) %>%
  count(day_of_week, hour = hour(start_datetime_utc)) %>%
  arrange(desc(n))

```

## 3 Plotting

### What proportion of scheduled sessions are training versus competition?

```{r}
olympic_schedule %>%
  group_by(is_training) %>%
  summarise(n = n()) %>%
  mutate(proportion = n / sum(n))
```

### Data Preparation for plot 1

```{r}
session_breakdown <- olympic_schedule %>%
  mutate(Type = ifelse(is_training, "Training", "Competition")) %>%
  count(Type) %>%
  mutate(prop = n / sum(n),
         label = paste0(Type, "\n", round(prop * 100, 1), "%"))
```

### Plot 1

```{r}
p1 <- session_breakdown %>% 
  ggplot(aes(x = 2, y = prop, fill = Type)) +
  geom_bar(stat = "identity", width = 1, color = "white") +
  coord_polar("y", start = 0) + 
  xlim(0.5, 2.5) +
  scale_fill_manual(values = c("Competition" = "#0081C8", "Training" = "#87CEEB")) +
  geom_text(aes(label = label), 
            position = position_stack(vjust = 0.5), 
            color = "white", 
            fontface = "bold",
            lineheight = 1, # Adjusting the gap that I made with \n\n
            size = 2) +
  theme_void() +
  labs(title = "Session Breakdown",
       subtitle = "Training vs. Competition") +
  theme(plot.title = element_text(face = "bold", size = 12, color = "#222222"),
        plot.subtitle = element_text(size = 9, color = "#555555"),
        legend.position = "none")
p1
```

### How does the schedule vary by day of the week?

```{r}
olympic_schedule %>%
  count(day_of_week) %>%
  mutate(day_of_week = factor(day_of_week, 
                              levels = c("Monday", "Tuesday", "Wednesday", "Thursday", 
                                         "Friday", "Saturday", "Sunday"))) %>%
  arrange(day_of_week)
```

### Data Preparation for plot 2

```{r}
weekly_data <- olympic_schedule %>%
  count(day_of_week) %>%
  mutate(day_of_week = factor(day_of_week, levels = c("Monday", "Tuesday", "Wednesday",
                                                      "Thursday", "Friday", "Saturday", "Sunday")))
```

### Plot 2

```{r}
p2 <- weekly_data %>% 
  ggplot(aes(x = day_of_week, y = n, fill = n)) +
  geom_col(width = 0.7) +
  scale_fill_gradient(low = "#5DADE2", high = "#0A2342") +
  scale_x_discrete(labels = function(x) str_sub(x, 1, 3)) +
  theme_light() +
  labs(title = "Weekly Momentum",
       subtitle = "Daily session counts across the 2026 Games",
       x = NULL,
       y = "Total Sessions") +
  theme(legend.position = "none",
        panel.grid.major.x = element_blank(),
        panel.border = element_blank(),
        plot.title = element_text(face = "bold", color = "#0A2342"))
p2
```

### Which venues host the most events?

```{r}
olympic_schedule %>%
  filter(!is.na(venue_name)) %>%
  count(venue_name, sort = TRUE) %>%
  slice_max(n, n = 10)
```

### Data Preparation for plot 3

```{r}
venue_data <- olympic_schedule %>%
  filter(!is.na(venue_name)) %>%
  count(venue_name, sort = TRUE) %>%
  slice_max(n, n = 10)
```

### Plot 3

```{r}
p3 <- venue_data %>% 
  ggplot(aes(x = n, y = reorder(venue_name, n))) +
  geom_segment(aes(x = 0, xend = n, y = venue_name, yend = venue_name), 
               color = "#0A2342", size = 1.5) +
  geom_point(color = "#0A2342", size = 5) +
  geom_point(color = "white", size = 1.5) +
  theme_light() +
  labs(title = "2026 Winter Olympics: Top 10 Venues",
       subtitle = "Venues ranked by total scheduled session volume",
       x = "Number of Sessions", y = NULL) +
  theme(panel.grid.major.y = element_blank(),
        panel.border = element_blank(),
        axis.line.x = element_line(color = "#0A2342"),
        plot.title = element_text(face = "bold", color = "#0A2342"))
p3
```

## Combination & Branding

```{r}
p1_centered <- wrap_elements(full = p1, clip = FALSE)

# I'm nesting the bottom row (p1 + p2) so we can control their relative widths
# widths = c(1, 2) gives the bar chart (p2) twice as much horizontal space as the donut
bottom_row <- (p1_centered + p2) + plot_layout(widths = c(1, 2))

# p3 + bottom row
combined_plot <- p3 / bottom_row + 
  plot_layout(heights = c(1.5, 1)) # Give top map more height

# Branding
final_branded_plot <- wrap_elements(combined_plot) +
  add_branding(
    github            = "gokturkcolak",
    linkedin          = "gokturkcolak",
    additional_text   = "Data: 2026 Winter Olympics | #TidyTuesday Week 6",
    text_position     = "before",
    line_spacing      = 1L,            # Keeps the 'L' fix for integer error
    text_color        = col_text,    
    text_family       = font_main,   
    icon_color        = col_accent, 
    caption_halign    = 1,
    icon_size         = "8pt",         
    text_size         = "7pt",         
    caption_margin    = margin(t = 10, b = 5, unit = "pt") 
  )
```

## Saving the plot

```{r}
ggsave(
  filename = "winter_olympics.png", 
  plot = final_branded_plot,
  width = 8, 
  height = 6, 
  dpi = 300,
  bg = "white"
)
```

